## Функции пользователя в PostgreSQL

## Базовый синтаксис
Функцию можно создать:
* с помощью кода PostgreSQL 
* с помощью PgAdmin GUI. 

```
CREATE [OR REPLACE] FUNCTION function_name (arguments) 
RETURNS return_datatype AS $variable_name$
   DECLARE
      declaration;
      [...]
   BEGIN
      < function_body >
      [.. logic]
      RETURN { variable_name | value }
   END; 
LANGUAGE language_name;
```

Запросы можно выполнять в оболочке PostgreSQL (PSQL), либо в среде PgAdmin (query tool).

__Пример.__

F(x)= e^x+5
```
CREATE OR REPLACE FUNCTION ex_plus_5(x double precision)
RETURNS double precision AS
$BODY$
BEGIN
 RETURN EXP(x) + 5;
END;
$BODY$
LANGUAGE plpgsql;
```

Выполним запрос для x=5:
```
SELECT  ex_plus_5(5);
```
## Числовыми функции в PostgreSQL

Тригонометрические функции
PostgreSQL поддерживает вычисление основных тригонометрических функций:
* SIN(n) – синус n (где n – угол в радианах);
* COS(n) – косинус n (где n – угол в радианах);
* TAN(n) – тангенс n (где n – угол в радианах);
* COT(n) – котангенс n (где n – угол в радианах). 

__Пример.__
```
SELECT SIN(0) X1, COS(0) X2, TAN(0) X3, COT(0) X4;
```
| X1  | X2  | X3  | X4       |
|-----|-----|-----|----------|
| 0   | 1   | 0   | Infinity |


## Числовые функции

__Функция ABS__

Функция ABS(n) возвращает абсолютное значение числа n. 

Например:
```
     SELECT ABS(100) X1, ABS(-100) X2, ABS(-100.2) X3;
```
| X1  | X2  | X3    |
|-----|-----|-------|
| 100 | 100 | 100.2 |

__Функция CEIL__

Функция CEIL(n) возвращает наименьшее целое, большее или равное переданному в качестве параметра числу n.

Например:
```
SELECT CEIL(100) X1, CEIL(-100) X2, CEIL(100.2) X3, CEIL(- 100.2) X4;
```
| X1  | X2   | X3  | X4|
|-----|------|-----|---|
| 100 | -100 | 101 |100|


__Функция FLOOR__

Функция FLOOR(n) возвращает наибольшее целое, меньшее или равное переданному в качестве параметра числу n.

Например:
```
SELECT FLOOR(100.22) X1, FLOOR(-100.22) X2,FLOOR(100.99) X3, FLOOR(100.01) X4;
```
| X1  | X2   | X3  | X4|
|-----|------|-----|---|
| 100 | -101 | 100 |100|

__Функция TRUNC__

Функция TRUNC(n[, m]) возвращает число n, усеченное до m знаков
после десятичной точки. Параметр m может не указываться – в этом случае n
усекается до целого.

Например:

```
SELECT TRUNC(100.25678) X1, TRUNC(-100.25678) X2, TRUNC(100.99) X3, TRUNC(100.25678, 2) X4;
```
| X1  | X2   | X3  | X4     |
|-----|------|-----|--------|
| 100 | -100 | 100 | 100.25 |

__Функция ROUND__

Функция ROUND(n[ ,m]) возвращает число n, округленное до m знаков после десятичной точки по правилам математического округления. 
Параметр m может не указываться – в этом случаеn округляется до целого.

Например:
```
SELECT ROUND(100.25678) X1, ROUND(100.5) X2, ROUND(100.99) X3, ROUND(100.25678, 2) X4;
```
| X1  | X2  | X3  | X4     |
|-----|-----|-----|--------|
| 100 | 101 | 101 | 100.26 |

__Функция SIGN__

Функция SIGN(n) определяет знак числа. Если n положительное, то функция возвращает 1. Если отрицательное – возвращается –1. Если равно нулю, то возвращается 0.

Например:
```
SELECT SIGN(100.22) X1, SIGN(-100.22) X2, SIGN(0) X3;
```
| X1 | X2  | X3  |
|---|-----|-----|
| 1 | -1  | 0   |

__Функция MOD__

Функция MOD(n,m) возвращает остаток отделения n на m. 

Например:
 ```    
SELECT MOD(10, 3) X1, MOD(10, 2) X2, MOD(100, 98) X3;
```
| X1 | X2 | X3|
|---|---|---|
| 1 | 0 | 2 |

__Функция POWER__

Функция POWER(n,m) возводит число n в степень m. Степень может быть
дробной и отрицательной, что существенно расширяет возможности данной
функции.
```
SELECT POWER(10, 2) X1, POWER(100, 0.5) X2, POWER(1000, 0.33333333) X3, POWER(1000, -0.33333333) X4;

```
| X1  | X2 | X3         | X4          |
|-----|----|------------|-------------|
| 100 | 10 | 9.999..934 | 0.100...851 |

В некоторых случаях при вызове данной функции может возникнуть исключительная ситуация.

Например:
```
SELECT POWER(-100, 0.5) X2;
```
В данном случае производится попытка вычисления квадратного корня от отрицательного числа, что приведет к возникновению ошибки «Отрицательное число в дробной степени дает комплексный результат».

__Функция SQRT__

Функция SQRT(n) возвращает квадратный корень от числа n. 

Например:
```
SELECT SQRT(100) X;
```
| X   |
|-----|
| 10  |

__Функции EXP и LN__

Функция EXP(n) возводит e в степень n, а функция LN(n) вычисляет натуральный логарифм от n (при этом значение n должно быть больше нуля).

Наример:
```
SELECT EXP(1) X1, LN(1) X2, LN(EXP(2)) X3;
```
| X1               | X2 | X3|
|------------------|---|---|
| 2.71828182845905 | 0 | 2 |

Попытка передать функции LN отрицательное значение приводит к возникновению 
ошибки «Вычислить логарифм отрицательного числа нельзя».

__Функция LOG__

Функция LOG(n, m) производит вычисление логарифма m по основанию n.

Наример:
```
SELECT LOG(2, 8) X1, LOG(10, 100) X2;
```

| X1 | X2 |
|---|---|
| 3 | 2 |

__Постановка задачи:__ В соответствии с вариантами в папке /images:

!Alt Text(images/z1.png)

1. Выполнить вычисления для выражений в PostgreSQL по примерам. 
Выполнение каждого примера показать в скриншоте экрана и ниже записать вводимое выражение. 
С помощью команд записи числовых функций psql получить значение выражения F(X), результат получить в виде таблицы:

| X | F(X)|
|---|-----|
|   |     |

2. Вычислить выражение Y, разработать структуру таблицы по порядку выполнения действий, добавить столбцы для заданных параметров с пользовательскими данными.
Например:

| X | 1 | 2 | 3 | 4 | 5 | 6 | 7 | Y |
|---|---|---|---|---|---|---|---|---|
||

