## Транзакции в PostgreSQL Часть 2

Уровни изоляции транзакций

Для конкретизации степени независимости параллельных транзакций вводится понятие уровня изоляции транзакций.
* Каждый уровень характеризуется перечнем тех феноменов, которые на данном уровне не допускаются.
* Всего в стандарте SQL предусмотрено четыре уровня:
1. __READ UNCOMMITTED__ (самый низкий)
2. __READ COMMITTED__  (по умолчанию в PostgreSQL)
3. __REPEATABLE READ__
4. __SERIALIZABLE__ (самый высокий)
* Каждый более высокий уровень включает в себя все возможности
предыдущего.


__READ UNCOMMITTED.__ Это самый низкий уровень изоляции. Согласно стандарту SQL, на этом уровне допускается чтение «грязных» (незафиксированных) данных. Однако в PostgreSQL требования, предъявляемые к этому уровню, более строгие, чем в стандарте: чтение «грязных» данных на этом уровне не допускается.

__READ COMMITTED.__ Не допускается чтение «грязных» (незафиксированных) данных. Таким образом, в PostgreSQL уровень READ UNCOMMITTED совпадает с уровнем READ COMMITTED. Транзакция может видеть только те незафиксированные изменения данных, которые произведены в ходе выполнения ее самой.

__REPEATABLE READ.__ Не допускается чтение «грязных» (незафиксированных) данных и неповторяющееся чтение. В PostgreSQL на этом уровне не допускается также фантомное чтение. Таким образом, реализация этого уровня является более строгой, чем того требует стандарт SQL. Это не противоречит стандарту.

__SERIALIZABLE.__ Не допускается ни один из феноменов, перечисленных выше, в том числе и аномалии сериализации.


Конкретный уровень изоляции обеспечивает сама СУБД с помощью своих внутренних механизмов.
Его достаточно указать в команде при старте транзакции.

По умолчанию PostgreSQL использует уровень изоляции READ COMMITTED.

```
SHOW default_transaction_isolation;
default_transaction_isolation -------------------------------
 read committed
(1 строка)
```

__Пример__

```
-- Терминал 1
BEGIN;
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
SELECT balance FROM accounts WHERE id = 1;
-- Предположим, баланс равен 1000

-- Терминал 2
BEGIN;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
COMMIT;

-- Терминал 1
SELECT balance FROM accounts WHERE id = 1;
-- Теперь баланс будет 900
COMMIT;
```

В этом примере мы видим, как работает уровень изоляции READ COMMITTED: транзакция видит изменения, сделанные другими завершенными транзакциями.

__Постановка задачи:__ В соответствии с вариантами индивидуальных заданий, выбранными в рамках лабораторной работы (L1.md), выполните задания:
1. Попробуйте выполнить параллельные транзакции с разными уровнями изоляции и проанализируйте результаты. (Продемонстрировать работу каждого уровня)
